<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Foosball Game</title>
    <script src="SAT.js"></script>
    <style>
     #container {
        width: 720px;
        height: 720px;
        border-style: solid;
        border-width: 10px;
        margin : 0 auto;
        position: relative;
        
     }
    canvas { 
        background: url("pitch3.png") center; 
        float: left;
        z-index: 1;
     }

     #startScreen {
        z-index: 2;
        width: 720px;
        height: 720px;
        background-image: url('splash.png');
        position: absolute;
        font-family: verdana;
        color: white;
     }
     #gameOverScreen {
        z-index: -1;
        width: 480px;
        height: 720px;
        background-image: url('splash.png');
        position: absolute;
        font-family: verdana;
        color: white;
     }
    #score {
        background-image: url('background.png');
        float: right;
        width: 240px;
        height: 690px;
        font-family: verdana;
        text-align: center;
        padding-top: 30px;
        z-index: 1;
    }
    #blue {
        color: #919191;
    }
    #red {
        color: #E03333;
    }
    #home, #away {
        font-size: 48px;
        font-weight: bold;
    }
    #timer {
        padding-bottom: 100px;
        font-size: 28px;
        font-weight: bold;
    }
    #credits {
        padding-top: 100px;
        font-size: 12px;
        font-weight: bold;
        position:fixed;
    height:50px;
    bottom:0px;
    left:0px;
    right:0px;
    margin-bottom:50px;
    margin-left: 475px;
    }
    a {
        text-decoration: none;
        color: #01BBE4;
    }
    #title {
        font-size: 50px;
        font-weight: bold;
        font-family: verdana;
        color: white;
        text-align: center;
        padding-top: 100px;

    }
   #play {
    margin-left: 300px;
    margin-top: 100px;
            width: auto;
            margin-bottom: 100px;
    padding: 20px 35px;
    background: white;
    border: 0;
    font-size: 20px;
    color: #424242;
    font-weight: bold;
    font-family: verdana;
    border-radius: 4px;
    margin-bottom: 10px;
}
   #playagain {
    margin-left: 140px;
    margin-top: 100px;
    width: auto;
    margin-bottom: 100px;
    padding: 20px 35px;
    background: white;
    border: 0;
    font-size: 20px;
    color: #424242;
    font-weight: bold;
    font-family: verdana;
    border-radius: 4px;
    margin-bottom: 10px;
}
#help {
   // margin-top: 100px;
   padding-left: 285px;
   opacity: 0.7;
}
#instructions {
    font-size: 12px;
    padding-left: 250px;
    text-align: center;
    opacity: 0.7;
}
#right {
    padding-left: 70px;
    font-size: 12px;
    text-align: center;
    opacity: 0.7;
}
#foot {
    margin-top: 160px;
    text-align: center;
    font-size: 10px;
    opacity: 0.5;
}
#status {
    margin-top: 100px;
    font-weight: bold;
    font-size: 20px;
}
    </style>
</head>
<body>
<div id = "container">


    <div id ="startScreen">
        <div id="title">FoosBall</div>
        <button id="play" onclick="init()">PLAY</button>
        <br><br><br>
        <img src="help.png" height="100" width="150" id="help">
        <br>
        <span id ="instructions">(Use left and right arrow keys to play)</span>
        <div id="foot">Written in vanilla Javascript using HTML5 canvas<br><br>By Prashant Baid<br><a href="http://www.google.com">Source Code</a></div>
    </div>

    <div id ="gameOverScreen">
        <div id="title">FoosBall</div>
        <button id="playagain" onclick="init()">PLAY AGAIN</button>
        <br><br><br>
    </div>


    <canvas id="myCanvas" width="480" height="720"></canvas>
    <div id="score">
        <div id = "timer">
            Time Left
            <div id = "countdown">02:00</div>
        </div>
        <h3 id = "blue">Juventus </h3>
        <div id="home">0</div>
        <h3 id = "red">Liverpool</h3>
        <div id="away">0</div>
        <div id = "status"></div>
        <div id = "credits"> Created By <br><a href = "http://twitter.com/prashantbaid">@prashantbaid</a></div>
    </div>
    
</div>
</body>
    <script>
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");

var x = canvas.width/2;
var y = canvas.height/2;
var ballRadius = 6;
var dx = 3;
var dy = -3;
var m = 0;
var j = 0;
var paddleHeight = 10;
var paddleWidth = 30;
var paddleX = (canvas.width-paddleWidth);
var rightPressed = false;
var leftPressed = false;    
var goalpostWidth = 150;
var goalpostHeight = 10;
var homeScore = 0;
var awayScore = 0;
var rightPressedAway = false;
var leftPressedAway = false;
var playerHeight = 50;
var playerWidth = 30;
var initFlag = true;
//console.log(canvas.height);
document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);

var V = SAT.Vector;
var C = SAT.Circle;
var B = SAT.Box;
var drawFlag = 1;
var circle;
var box;
// A square
var gameOver = false;
var homePlayer = new Image();
var awayPlayer = new Image();
function init() {
    removeStatus();
     homePlayer.src = 'homePlayer.png';
     awayPlayer.src = 'awayPlayer.png'; 
    document.getElementById('startScreen').style['z-index'] = '-1';
    document.getElementById('gameOverScreen').style['z-index'] = '-1';
    document.getElementById('home').innerHTML = '0';
    document.getElementById('away').innerHTML = '0';
    removeStatus();
    awayScore = 0;
    homeScore = 0;
    gameOver = 0;
 //window.requestAnimationFrame(draw);
 setInitialDelay();
}

function setInitialDelay() {
    setTimeout(function(){       
        drawFlag = 1;
        window.requestAnimationFrame(draw);
        startTimer(60*2);
}, 1500); 
}

function setDelay() {
    setTimeout(function(){       
        drawFlag = 1;
        window.requestAnimationFrame(draw);
}, 1500); 
}
var countdown;
function startTimer(duration) {
    var timer = duration, minutes, seconds;
    countdown = setInterval(function () {
        minutes = parseInt(timer / 60, 10)
        seconds = parseInt(timer % 60, 10);

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        document.getElementById('countdown').innerHTML = minutes + ":" + seconds;

        if (--timer < 0) {
            document.getElementById('gameOverScreen').style['z-index'] = 3;
            gameOver = true;
            clearInterval(countdown);
            if(homeScore>awayScore)
                updateStatus('GAME OVER!<br>Juventus Win!');
            else if(awayScore>homeScore)
                updateStatus('GAME OVER!<br>Liverpool Win!');
            else
                updateStatus('GAME OVER!<br>Draw!')
        }
    }, 1000);
}


function drawBall() {
      ctx.beginPath();
      ctx.arc(x, y, ballRadius, 0, Math.PI*2);
      ctx.fillStyle = "white";
      ctx.fill();
      ctx.closePath();
circle = new C(new V(x,y), 6);
    if(x + dx > canvas.width-ballRadius || x + dx < ballRadius) {
    dx = -dx;
    }
    if(y + dy > canvas.height-ballRadius || y + dy < ballRadius) {
        dy = -dy;
    }

}


function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBall();
    drawPlayers();
    drawGoalPost();
  //  console.log('Home: ', homeScore, 'Away: ', awayScore);
    x += dx;
    y += dy;
    if(rightPressed && paddleX*3/4 + m < canvas.width-paddleWidth) {
        m += 2;  
    }
    else if(leftPressed && paddleX/4 + m > 0) {
        m -= 2;
    }
    if(drawFlag && !gameOver)
        window.requestAnimationFrame(draw);

        
    // else if(x > canvas.width/2 && paddleX*7/8 + j < canvas.width-paddleWidth) {
    //     j += 15;
    // }
    // else if(x < canvas.width/2 && paddleX*1/8 + j > 0) {
    //     j -= 15;
    // }
}

function updateScore(goal) {

    if(goal === 'home') {
        awayScore += 1;
        document.getElementById('away').innerHTML = awayScore;
    }
    else {
        homeScore += 1;
        document.getElementById('home').innerHTML = homeScore;
    }
}

function resetBall() {
    x = canvas.width/2;
    y = canvas.height/2;
    drawBall();
    drawFlag = 0;
    window.requestAnimationFrame(draw);
     
}
function updateStatus(message) {
    document.getElementById('status').innerHTML = message;
    
}

function removeStatus() {
        setTimeout(function(){       
        document.getElementById('status').innerHTML = '';
}, 1500); 
}
function drawGoalPost() {

    //home
    ctx.beginPath();
    var gphX = (canvas.width - goalpostWidth)/2;
    var gphY = canvas.height - goalpostHeight;
    ctx.rect(gphX, gphY, goalpostWidth, goalpostHeight);
    ctx.fillStyle = "#9C9C9C";
    ctx.fill();
    ctx.closePath();
    box = new B(new V(gphX,gphY), goalpostWidth, goalpostHeight).toPolygon();
    if(goalDetection(box)) {
        updateScore('home');
        updateStatus('GOAL!<br>Juventus Score!');
        removeStatus();
        resetBall();   
        setDelay();
    }


   // if(y == canvas.height)
       
    // if(y >= gphY && (x > gphX && x < gphX + goalpostWidth)) {
    //     //console.log('home scored');

    //     updateScore('home');
    //     updateStatus('GOAL!<br>Juventus Score!');
    //     removeStatus();
    //     resetBall();   
    //     setDelay();
    // }
    //console.log('called');
    //away
    ctx.beginPath();
    var gpaX = (canvas.width - goalpostWidth)/2;
    var gpaY = paddleHeight - goalpostHeight;
    ctx.rect(gpaX, gpaY, goalpostWidth, goalpostHeight);
    ctx.fillStyle = "#9C9C9C";
    ctx.fill();
    ctx.closePath();

    box = new B(new V(gpaX,gpaY), goalpostWidth, goalpostHeight).toPolygon();
    if(goalDetection(box)) {
        updateScore('away');
        updateStatus('GOAL!<br>Liverpool Score!');
        removeStatus();
        resetBall();   
        setDelay();
    }
    // alert(y + ','+ gpaY);
    // if(y <= gpaY && (x > gpaX && x < gpaX + goalpostWidth)) {
    //     //console.log('away scored'); 
    //     updateScore('away');
    //     updateStatus('GOAL!<br>Liverpool Score!');
    //     removeStatus();
    //     resetBall();
    //     setDelay();
    // }
}

function goalDetection(box) {
    var response = new SAT.Response();
    return SAT.testPolygonCircle(box, circle, response);
}


function drawGoalkeeper() {
    console.log('called');
    ctx.beginPath();
    var gkX = paddleX/2 + m;
    var gkY = canvas.height*7/8-paddleHeight;
    ctx.drawImage(homePlayer, gkX, gkY - 15 , playerWidth, playerHeight);
    ctx.rect(0, gkY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    ctx.closePath();
    box = new B(new V(gkX,gkY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, gkX);
    
}

      var  flag1 = 1;
      var flag2 = 1;

function collisionDetection(box, pX) {
    var response = new SAT.Response();
    if(SAT.testPolygonCircle(box, circle, response)) {
var speed = (x + (12/2) - pX + (20/2)) /
                (20/2) * 5;
               // console.log('speed', speed);
    if(flag1 == 1) {
         if(dy > 0) {
             dy = -dy;
             y = y - speed;
             if(dx > 0)
                 x = x + speed;
             else
                 x = x - speed;
         }
         else {
             y = y - speed;
             if(dx > 0)
                 x = x - speed;
             else
                 x = x + speed;
         }
         flag1 = 0;
     }

       


       // relativeIntersectY = (paddle2Y + (PADDLEHEIGHT / 2)) - intersectY;
       // var factor=(x-pX)/16;
       // console.log(factor);
       //     bounceAngle = (y / (playerHeight / 2)) * (Math.PI / 2 - Math.PI/12);
       //     ballSpeed = Math.sqrt(x * x + y * y);
           // ballTravelLeft = (newBallY - intersectY) / (newBallY - ballY);
        //    x = ballSpeed * Math.cos(bounceAngle) * -1;
        //    y = ballSpeed * Math.sin(bounceAngle) * -1;
          //  newBallX = intersectX - ballTravelLeft * ballSpeed * Math.cos(bounceAngle);
          //  newBallY = intersectY - ballTravelLeft * ballSpeed * Math.sin(bounceAngle);
        
        // if(dy < 0) 
        //     dx = -dx;
        // else
        //     dy = -dy;
    }
    else 
        flag1 =1;
}

function collisionDetectionAway(box) {
    var response = new SAT.Response();
    if(SAT.testPolygonCircle(box, circle, response)) {
      //  dy = -dy;
      //  y = y + 5;
    if(flag2 == 1) {
        if(dy < 0) {
            dy = -dy;
            y = y + 5;
            if(dx > 0)
                x = x + 5;
            else
                x = x - 5;
        }
        else {
            y = y + 5;
            if(dx > 0)
                x = x + 5;
            else
                x = x - 5;
        }
    }
        // if(dy > 0) {
        //     dx = -dx;
        //     x = x + dx + 5; 
        // }
        // else {
        //     dy = -dy;
        //     y = y + dy + 5;
        // }
    }
    else
        flag2 = 1;
}


function drawDefenders() {

    ctx.beginPath();
    var lcbX = paddleX/4 + m;
    var lcbY = canvas.height*13/16-paddleHeight;
   // ctx.rect(lcbX, lcbY, paddleWidth, paddleHeight);
    ctx.rect(0, lcbY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    ctx.closePath();
    ctx.drawImage(homePlayer, lcbX, lcbY - 15, playerWidth, playerHeight);
    box = new B(new V(lcbX,lcbY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, lcbX);
    

    ctx.beginPath();
    var rcbX = paddleX*3/4 + m;
    var rcbY = canvas.height*13/16-paddleHeight;
   // ctx.rect(rcbX, rcbY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, rcbX, rcbY - 15, playerWidth, playerHeight);
    box = new B(new V(rcbX,rcbY), playerWidth, paddleHeight).toPolygon();
    
    collisionDetection(box, rcbX);
}

function drawMidfielders() {

    //midfielders
    ctx.beginPath();
    var lwbX = paddleX*1/8 + m;
    var lwbY = canvas.height*5/8-paddleHeight;
    //ctx.rect(lwbX, lwbY, paddleWidth, paddleHeight);
    ctx.rect(0, lwbY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    ctx.closePath();
    ctx.drawImage(homePlayer, lwbX, lwbY - 15, playerWidth, playerHeight);
    box = new B(new V(lwbX,lwbY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, lwbX);


    ctx.beginPath();
    var lcmX = paddleX*3/8 + m;
    var lcmY = canvas.height*5/8-paddleHeight;
  //  ctx.rect(lcmX, lcmY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, lcmX, lcmY - 15, playerWidth, playerHeight);
    box = new B(new V(lcmX,lcmY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, lcmX);

    ctx.beginPath();
    var rcmX = paddleX*5/8 + m;
    var rcmY = canvas.height*5/8-paddleHeight;
   // ctx.rect(rcmX, rcmY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, rcmX, rcmY - 15, playerWidth, playerHeight);
    box = new B(new V(rcmX,rcmY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, rcmX);

    ctx.beginPath();
    var rwbX = paddleX*7/8 + m;
    var rwbY = canvas.height*5/8-paddleHeight;
   // ctx.rect(rwbX, rwbY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, rwbX, rwbY - 15, playerWidth, playerHeight);
    box = new B(new V(rwbX,rwbY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, rwbX);
  
}

function drawStrikers() {
        //attackers
    ctx.beginPath();
    var lwX = paddleX/4 + m;
    var lwY = canvas.height*9/32-paddleHeight;
   // ctx.rect(lwX, lwY, paddleWidth, paddleHeight);
    ctx.rect(0, lwY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    //ctx.fillStyle = "#0095DD";
    //ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, lwX, lwY - 15, playerWidth, playerHeight);
    box = new B(new V(lwX,lwY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, lwX);

    ctx.beginPath();
    var cfX = paddleX/2 + m;
    var cfY = canvas.height*9/32-paddleHeight;
   // ctx.rect(cfX, cfY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, cfX, cfY - 15, playerWidth, playerHeight);
    box = new B(new V(cfX,cfY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, cfX);

    ctx.beginPath();
    var rwX = paddleX*3/4 + m;
    var rwY = canvas.height*9/32-paddleHeight;
   // ctx.rect(rwX, rwY, paddleWidth, paddleHeight);
    ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(homePlayer, rwX, rwY - 15, playerWidth, playerHeight);
    box = new B(new V(rwX,rwY), playerWidth, paddleHeight).toPolygon();
    collisionDetection(box, rwX);

}

function drawPlayers() {

    //home
    drawGoalkeeper();
    drawDefenders();
    drawMidfielders();
    drawStrikers();

    //away
     drawAwayGoalkeeper();
     drawAwayDefenders();
     drawAwayMidfielders();
     drawAwayStrikers();
}

function drawAwayGoalkeeper() {

    ctx.beginPath();
    var gkX = paddleX/2 + j;
    var gkY = canvas.height*1/8-paddleHeight;
    ctx.rect(0, gkY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.strokeStyle = 'black';
    ctx.fill();
    ctx.stroke();
    ctx.closePath();
    ctx.drawImage(awayPlayer, gkX, gkY - 15, playerWidth, playerHeight);
    box = new B(new V(gkX,gkY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);
    
  //  if(y + 10 == gkY || y - 10 == gkY) {
        if(x > gkX && gkX < paddleX * 3/4)
            j +=1;
        else if(gkX > paddleX * 1/4)
            j -=1;
   // }

    // if(x > canvas.width/2 && gkX < paddleX * 3/4)
    //     j +=1.5;
    // else if(gkX > paddleX * 1/4)
    //     j -=1.5;

}

function drawAwayDefenders() {

    ctx.beginPath();
    var lcbX = paddleX/4 + j;
    var lcbY = canvas.height*3/16-paddleHeight;
    ctx.rect(0, lcbY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.strokeStyle = 'black';
    ctx.fill();
    ctx.stroke();
    
    ctx.closePath();
    ctx.drawImage(awayPlayer, lcbX, lcbY - 15, playerWidth, playerHeight);
    box = new B(new V(lcbX,lcbY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var rcbX = paddleX*3/4 + j;
    var rcbY = canvas.height*3/16-paddleHeight;
    //ctx.rect(rcbX, rcbY, paddleWidth, paddleHeight);
   // ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, rcbX, rcbY - 15, playerWidth, playerHeight);
    box = new B(new V(rcbX,rcbY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

   // if(y + 10 == rcbY || y - 10 == rcbY) {
        if(x > lcbX && lcbX < paddleX * 3/4)
            j +=1;
        else if(lcbX > paddleX * 1/4)
            j -=1;
        if(x > rcbX && rcbX < paddleX * 3/4)
            j +=1;
        else if(rcbX > paddleX * 1/4)
            j -=1;
    }
//}

function drawAwayMidfielders() {

    //midfielders
    ctx.beginPath();
    var lwbX = paddleX*1/8 + j;
    var lwbY = canvas.height*3/8-paddleHeight;
   // ctx.rect(lwbX, lwbY, paddleWidth, paddleHeight);
    ctx.rect(0, lwbY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    ctx.closePath();
    ctx.drawImage(awayPlayer, lwbX, lwbY - 15, playerWidth, playerHeight);
    box = new B(new V(lwbX,lwbY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var lcmX = paddleX*3/8 + j;
    var lcmY = canvas.height*3/8-paddleHeight;
   // ctx.rect(lcmX, lcmY, paddleWidth, paddleHeight);
   // ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, lcmX, lcmY - 15, playerWidth, playerHeight);
    box = new B(new V(lcmX,lcmY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var rcmX = paddleX*5/8 + j;
    var rcmY = canvas.height*3/8-paddleHeight;
   // ctx.rect(rcmX, rcmY, paddleWidth, paddleHeight);
    //ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, rcmX, rcmY - 15, playerWidth, playerHeight);
    box = new B(new V(rcmX,rcmY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var rwbX = paddleX*7/8 + j;
    var rwbY = canvas.height*3/8-paddleHeight;
   // ctx.rect(rwbX, rwbY, paddleWidth, paddleHeight);
   // ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, rwbX, rwbY - 15, playerWidth, playerHeight);
    box = new B(new V(rwbX,rwbY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

   // if(y + 10 == rwbY || y - 10 == rwbY) {
        if(x > lwbX && lwbX < paddleX * 3/4)
            j +=1;
        else if(lwbX > paddleX * 1/4)
            j -=1;
        if(x > rwbX && rwbX < paddleX * 3/4)
            j +=1;
        else if(rwbX > paddleX * 1/4)
            j -=1;
        if(x > rcmX && rcmX < paddleX * 3/4)
            j +=1;
        else if(rcmX > paddleX * 1/4)
            j -=1;
        if(x > lcmX && lcmX < paddleX * 3/4)
            j +=1;
        else if(lcmX > paddleX * 1/4)
            j -=1;
    }
  
//}

function drawAwayStrikers() {
        //attackers
    ctx.beginPath();
    var lwX = paddleX/4 + j;
    var lwY = canvas.height*23/32-paddleHeight;
    //ctx.rect(lwX, lwY, paddleWidth, paddleHeight);
    ctx.rect(0, lwY+2, canvas.width, paddleHeight-5);
    ctx.fillStyle = "#BDBDBD";
    ctx.fill();
    ctx.strokeStyle = 'black';
    ctx.stroke();
    //ctx.fillStyle = "#E03333";
    
    ctx.closePath();
    ctx.drawImage(awayPlayer, lwX, lwY - 15, playerWidth, playerHeight);
    box = new B(new V(lwX,lwY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var cfX = paddleX/2 + j;
    var cfY = canvas.height*23/32-paddleHeight;
   // ctx.rect(cfX, cfY, paddleWidth, paddleHeight);
   // ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, cfX, cfY - 15, playerWidth, playerHeight);
    box = new B(new V(cfX,cfY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);

    ctx.beginPath();
    var rwX = paddleX*3/4 + j;
    var rwY = canvas.height*23/32-paddleHeight;
   // ctx.rect(rwX, rwY, paddleWidth, paddleHeight);
   // ctx.fillStyle = "#E03333";
    ctx.fill();
    ctx.closePath();
    ctx.drawImage(awayPlayer, rwX, rwY - 15, playerWidth, playerHeight);
    box = new B(new V(rwX,rwY), playerWidth, paddleHeight).toPolygon();
    collisionDetectionAway(box);


   // if(y + 10 == rwY || y - 10 == rwY) {
        if(x > lwX && lwX < paddleX * 3/4)
            j +=1;
        else if(lwX > paddleX * 1/4)
            j -=1;
        if(x > rwX && rwX < paddleX * 3/4)
            j +=1;
        else if(rwX > paddleX * 1/4)
            j -=1;
        if(x > cfX && cfX < paddleX * 3/4)
            j +=1;
        else if(cfX > paddleX * 1/4)
            j -=1;
    //}

    
}

function keyDownHandler(e) {
    if(e.keyCode == 39) {
        rightPressed = true;
    }
    else if(e.keyCode == 37) {
        leftPressed = true;
    }
    else if(e.keyCode == 65) {
        leftPressedAway = true; 
    }
    else if(e.keyCode == 68) {
        rightPressedAway = true;
    }
}

function keyUpHandler(e) {
    if(e.keyCode == 39) {
        rightPressed = false;
    }
    else if(e.keyCode == 37) {
        leftPressed = false;
    }
    else if(e.keyCode == 65) {
        leftPressedAway = false; 
    }
    else if(e.keyCode == 68) {
        rightPressedAway = false;
    }
}
//init();
    </script>
</html>